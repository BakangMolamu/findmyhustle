<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Upload Your Hustle — FindMyHustle</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{--glass: rgba(255,255,255,0.85);} 
    html,body{height:100%;margin:0;font-family:'Poppins',system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#0b1320}
    body{
      background: linear-gradient(135deg,#c8f1ff 0%, #d6c3ff 50%, #e6d5ff 100%);
      display:flex;align-items:center;justify-content:center;padding:24px;
    }
    .card{max-width:820px;width:100%;background:var(--glass);backdrop-filter:blur(6px);border-radius:14px;box-shadow:0 8px 30px rgba(11,19,32,0.12);padding:20px 22px}
    h1{margin:0 0 6px;font-weight:600;font-size:20px}
    p.lead{margin:0 0 18px;color:#10203a}
    form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{display:block;font-size:13px;margin-bottom:6px;color:#1b2a44}
    input[type=text],input[type=email],textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(11,19,32,0.08);font-size:14px}
    textarea{min-height:92px;resize:vertical}
    .full{grid-column:1/-1}
    .actions{display:flex;gap:10px;align-items:center;justify-content:flex-end;margin-top:6px}
    button{background:linear-gradient(90deg,#6c63ff,#4facff);color:white;border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;color:#10203a;border:1px solid rgba(11,19,32,0.06)}
    .note{font-size:13px;color:#2a3b56}
    .msg{padding:10px;border-radius:8px;margin-top:10px}
    .msg.success{background:#e6fbf0;color:#064e2a}
    .msg.error{background:#fff1f2;color:#6b0f1a}
    .img-preview{display:flex;gap:8px;align-items:center}
    .img-preview img{width:84px;height:84px;object-fit:cover;border-radius:8px;border:1px solid rgba(11,19,32,0.06)}
    @media (max-width:720px){form{grid-template-columns:1fr} .actions{justify-content:stretch} button{width:100%}}
  </style>
</head>
<body>
  <div class="card">
    <h1>Upload your hustle</h1>
    <p class="lead">Fill the form below and we'll add your profile to the FindMyHustle spreadsheet. <strong>Required:</strong> Name, Skill, Picture1URL, Picture2URL.</p><form id="hustleForm" autocomplete="off">
  <div>
    <label for="name">Full name *</label>
    <input id="name" name="Name" type="text" placeholder="e.g. Thabo M" required />
  </div>

  <div>
    <label for="skill">Skill *</label>
    <input id="skill" name="Skill" type="text" placeholder="e.g. Tailor, Packer, Photographer" required />
  </div>

  <div>
    <label for="province">Province</label>
    <input id="province" name="Province" type="text" placeholder="e.g. Gauteng" />
  </div>

  <div>
    <label for="city">City</label>
    <input id="city" name="City" type="text" placeholder="e.g. Johannesburg" />
  </div>

  <div class="full">
    <label for="email">Email</label>
    <input id="email" name="Email" type="email" placeholder="optional" />
  </div>

  <div class="full">
    <label for="phone">Phone / WhatsApp</label>
    <input id="phone" name="Phone" type="text" placeholder="e.g. +27 82 555 1234" />
  </div>

  <div class="full">
    <label for="description">Short description</label>
    <textarea id="description" name="Description" placeholder="Tell customers what you do (1-2 lines)"></textarea>
  </div>

  <div>
    <label for="pic1">Picture 1 URL *</label>
    <input id="pic1" name="Picture1URL" type="text" placeholder="Direct image URL (Imgur / Cloudinary / public Drive link)" required />
  </div>

  <div>
    <label for="pic2">Picture 2 URL *</label>
    <input id="pic2" name="Picture2URL" type="text" placeholder="Another image URL" required />
  </div>

  <div>
    <label for="video">Video URL</label>
    <input id="video" name="VideoURL" type="text" placeholder="YouTube or public video link (optional)" />
  </div>

  <div class="full img-preview" id="previews">
    <!-- live previews inserted here -->
  </div>

  <div class="full note">
    Tip: the script stores image links — host images somewhere public (Imgur, Cloudinary, or Google Drive public link). If you want help hosting images, tell me and I can show steps.
  </div>

  <div class="full actions">
    <button type="button" id="submitBtn">Submit listing</button>
    <button type="button" id="clearBtn" class="ghost">Clear</button>
  </div>

  <div id="messageArea" class="full"></div>
</form>

  </div>  <script>
    // CHANGE THIS to your web app URL (already set by the page creator)
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzUGuj9eN4_xEBNHIEr_sypGVXJ7QA6j04UjdZ9Wzc1zYiYezEaX2p-eF_d7haAXBff/exec";

    const form = document.getElementById('hustleForm');
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');
    const messageArea = document.getElementById('messageArea');
    const previews = document.getElementById('previews');

    function showMessage(text, type='success'){
      messageArea.innerHTML = '';
      const div = document.createElement('div');
      div.className = 'msg ' + (type === 'error' ? 'error' : 'success');
      div.textContent = text;
      messageArea.appendChild(div);
    }

    function clearMessage(){ messageArea.innerHTML = ''; }

    function updatePreviews(){
      previews.innerHTML = '';
      const urls = [document.getElementById('pic1').value.trim(), document.getElementById('pic2').value.trim()];
      urls.forEach(u => {
        if (!u) return;
        const img = document.createElement('img');
        img.src = u;
        img.alt = 'preview';
        img.onerror = () => { img.style.opacity = 0.5; img.title = 'Could not load image — check the URL'; };
        previews.appendChild(img);
      });
    }

    document.getElementById('pic1').addEventListener('input', updatePreviews);
    document.getElementById('pic2').addEventListener('input', updatePreviews);

    clearBtn.addEventListener('click', () => {
      form.reset(); previews.innerHTML = ''; clearMessage();
    });

    submitBtn.addEventListener('click', async () => {
      clearMessage();

      const payload = {
        Name: document.getElementById('name').value.trim(),
        Email: document.getElementById('email').value.trim(),
        Skill: document.getElementById('skill').value.trim(),
        Province: document.getElementById('province').value.trim(),
        City: document.getElementById('city').value.trim(),
        Description: document.getElementById('description').value.trim(),
        Phone: document.getElementById('phone').value.trim(),
        Picture1URL: document.getElementById('pic1').value.trim(),
        Picture2URL: document.getElementById('pic2').value.trim(),
        VideoURL: document.getElementById('video').value.trim()
      };

      // client-side validation for required fields
      const missing = [];
      if (!payload.Name) missing.push('Name');
      if (!payload.Skill) missing.push('Skill');
      if (!payload.Picture1URL) missing.push('Picture1URL');
      if (!payload.Picture2URL) missing.push('Picture2URL');
      if (missing.length) return showMessage('Missing required: ' + missing.join(', '), 'error');

      // disable UI
      submitBtn.disabled = true; submitBtn.textContent = 'Submitting...';

      try{
        const res = await fetch(WEB_APP_URL, {
          method: 'POST',
          mode: 'cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        // Apps Script returns JSON text
        const data = await res.json();

        if (data && data.status === 'success'){
          showMessage('Success! Listing created with id: ' + data.id);
          form.reset(); previews.innerHTML = '';
        } else if (data && data.status === 'error'){
          showMessage('Error: ' + (data.message || 'unknown'), 'error');
        } else {
          // sometimes script returns array/object — show it
          showMessage('Response: ' + JSON.stringify(data));
        }

      } catch (err){
        console.error(err);
        // Common cause: CORS or network. Show helpful troubleshooting note.
        showMessage('Network error or CORS problem. Check your web app deployment (must allow Anyone, even anonymous).\n' + err.message, 'error');
      } finally{
        submitBtn.disabled = false; submitBtn.textContent = 'Submit listing';
      }
    });

    // friendly tip: open developer console for errors
    (function(){
      // small UX improvement: press Enter to submit when in last field
      form.addEventListener('submit', (ev) => { ev.preventDefault(); submitBtn.click(); });
    })();
  </script></body>
      </html>
