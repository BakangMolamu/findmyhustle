<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Upload Hustle - FindMyHustle</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body{
  font-family:Poppins,Arial,sans-serif;
  background:#f4f7fb;
  padding:20px;
  color:#123;
}
h1{text-align:center;color:#135f9a}

form{
  max-width:520px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 8px 25px rgba(0,0,0,.08);
}

label{font-weight:600;margin-top:14px;display:block;font-size:14px}
input{
  width:100%;
  padding:10px;
  margin-top:6px;
  border:1px solid #ddd;
  border-radius:8px;
  font-size:14px;
}

button{
  margin-top:22px;
  width:100%;
  background:#135f9a;
  color:white;
  border:none;
  padding:12px;
  font-size:16px;
  border-radius:10px;
  cursor:pointer;
}
button:hover{background:#0f4f7a}

#status{
  margin-top:15px;
  font-weight:600;
  text-align:center;
  display:none;
}

#mama-suzan-btn{
  position:fixed;
  bottom:20px;
  right:20px;
  background:white;
  border:2px solid #135f9a;
  color:#135f9a;
  padding:10px 14px;
  border-radius:30px;
  font-weight:700;
  cursor:pointer;
}

#mama-suzan-box{
  display:none;
  position:fixed;
  bottom:80px;
  right:20px;
  width:300px;
  background:white;
  padding:15px;
  border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  font-size:14px;
}
</style>
</head>

<body>

<h1>Upload Your Hustle</h1>

<form id="hustleForm">
  <label>Name</label>
  <input name="name" required>

  <label>Skill / Hustle</label>
  <input name="skill" required>

  <label>Province</label>
  <input name="province" required>

  <label>City</label>
  <input name="city" required>

  <label>Phone</label>
  <input name="phone">

  <label>Email</label>
  <input type="email" name="email">

  <label>Date</label>
  <input type="date" name="date" required>

  <label>Work Image URL 1</label>
  <input type="url" name="image1" required>

  <label>Work Image URL 2</label>
  <input type="url" name="image2">

  <button type="submit">Submit Hustle (Free)</button>

  <div id="status" role="status" aria-live="polite"></div>
</form>

<button id="mama-suzan-btn" onclick="toggleMamaSuzan()">üßì Need Help?</button>

<div id="mama-suzan-box">
  <p>üßì Hello ngwanake ‚ù§Ô∏è</p>
  <p>This platform is completely FREE.</p>
  <p>Add clear image links of your work so people can see what you do.</p>
  <p>Mama Suzan is proud of you.</p>
</div>

<script>
/*
  IMPORTANT:
  1) Replace below with your deployed Apps Script Web App URL (deployed as "Execute as: Me" and "Who has access: Anyone")
  2) Make sure your Apps Script doPost returns JSON like { status: "success", message: "..."}
*/
const scriptURL = "https://script.google.com/macros/s/AKfycbzUaUmJe5BXagtPTWpP0FwQe9_ngrJL5_BBraTF3pedVbmFQ1xzXh1UOonUSzWOLJ8oNA/exec"; // <-- replace this

const form = document.getElementById("hustleForm");
const statusMsg = document.getElementById("status");

function showStatus(text, color = "#333") {
  statusMsg.style.display = "block";
  statusMsg.style.color = color;
  statusMsg.textContent = text;
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  // Basic client-side validation for the required image URL field
  const image1 = form.querySelector('input[name="image1"]').value.trim();
  if (!image1) {
    showStatus("Please provide at least one image URL.", "crimson");
    return;
  }

  showStatus("Submitting...", "#555");

  try {
    const res = await fetch(scriptURL, {
      method: "POST",
      body: new FormData(form)
    });

    // try parse JSON first (Apps Script returns JSON in the current setup)
    let data;
    const text = await res.text();
    try { data = JSON.parse(text); } catch (err) { data = null; }

    if (!res.ok) {
      // non-2xx HTTP status
      showStatus("‚ùå Submission failed (server). Try again.", "crimson");
      console.error("Server error", res.status, text);
      return;
    }

    // If JSON contains a success flag use it, otherwise accept non-empty reply
    if (data && data.status === "success") {
      showStatus("‚úÖ Hustle uploaded successfully!", "green");
      form.reset();
      // set date back to today (optional UX)
      document.querySelector('input[name="date"]').value = new Date().toISOString().slice(0,10);
    } else {
      // If server returned something but not the success JSON
      showStatus("‚úÖ Submitted (server responded).", "green");
      form.reset();
      document.querySelector('input[name="date"]').value = new Date().toISOString().slice(0,10);
      console.log("Server response:", text);
    }
  } catch (err) {
    showStatus("‚ùå Submission failed (network). Check your connection.", "crimson");
    console.error("Fetch error:", err);
  }
});

function toggleMamaSuzan(){
  const box = document.getElementById('mama-suzan-box');
  box.style.display = box.style.display === 'block' ? 'none' : 'block';
}
</script>

</body>
</html>
