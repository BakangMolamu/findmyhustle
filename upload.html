<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Upload Your Hustle — FindMyHustle</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root{--p1:#3b0a57;--p2:#0d1a5e;--card-bg:rgba(255,255,255,0.06);--accent1:#7b3fe4;--accent2:#4bc0ff}
  *{box-sizing:border-box}
  body{margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,var(--p1),var(--p2));color:#fff;padding:18px}
  .wrap{max-width:820px;margin:18px auto}
  .card{background:var(--card-bg);padding:20px;border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,0.35)}
  h1{text-align:center;margin:0 0 8px}
  label{display:block;margin-top:12px;font-weight:600}
  input,select,textarea{width:100%;padding:10px;border-radius:10px;border:none;margin-top:6px;font-size:14px}
  .row{display:flex;gap:12px}
  .row .col{flex:1}
  .thumbs{display:flex;gap:12px;margin-top:10px}
  .thumb{flex:1;min-height:140px;background:rgba(0,0,0,0.12);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#ddd;overflow:hidden}
  .thumb img{width:100%;height:100%;object-fit:cover;}
  .note{font-size:13px;color:rgba(255,255,255,0.85)}
  button{margin-top:16px;padding:12px;border-radius:10px;border:none;width:100%;font-weight:800;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;cursor:pointer}
  #overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.45);align-items:center;justify-content:center;z-index:9998}
  #overlay.show{display:flex}
  .overlay-box{background:rgba(255,255,255,0.06);padding:14px;border-radius:10px}
  #success{position:fixed;left:50%;top:-120px;transform:translateX(-50%);background:#4cd964;color:#002;padding:12px 16px;border-radius:12px;font-weight:700;z-index:9999;transition:0.5s;opacity:0}
  #success.show{top:20px;opacity:1}
  @media(max-width:620px){.row{flex-direction:column}}
</style>
</head>
<body>
<div id="success">✅ Submitted — we'll contact you after verification.</div>
<div id="overlay"><div class="overlay-box">Submitting — please wait…</div></div>

<div class="wrap">
  <main class="card">
    <h1>Upload Your Hustle</h1>
    <p class="note">Paste two *direct* image links (Imgur/ImgBB recommended). Optional video link (YouTube/Vimeo).</p>

    <form id="form" novalidate>
      <label>Full Name</label>
      <input id="name" name="Name" type="text" required>

      <div class="row">
        <div class="col">
          <label>Skill</label>
          <select id="skill" name="Skill" required>
            <option value="">Select skill</option>
            <option>Barber</option><option>Hairdresser</option><option>Nail Technician</option><option>Photographer</option><option>Videographer</option><option>Plumber</option><option>Electrician</option><option>Chef</option><option>Tailor</option><option>Other</option>
          </select>
        </div>
        <div class="col">
          <label>Province</label>
          <select id="province" name="Province" required>
            <option value="">Select province</option>
            <option>Eastern Cape</option><option>Free State</option><option>Gauteng</option><option>KwaZulu-Natal</option><option>Limpopo</option><option>Mpumalanga</option><option>Northern Cape</option><option>North West</option><option>Western Cape</option>
          </select>
        </div>
      </div>

      <label>City / Town</label>
      <input id="city" name="City" type="text" required>

      <label>Email (optional)</label>
      <input id="email" name="Email" type="email" placeholder="you@example.com">

      <label>Phone / WhatsApp</label>
      <input id="phone" name="Phone" type="tel" placeholder="+27..." required>

      <label>Short description</label>
      <textarea id="description" name="Description"></textarea>

      <div class="thumbs" aria-hidden="true">
        <div class="thumb" id="thumb1">Picture 1 preview</div>
        <div class="thumb" id="thumb2">Picture 2 preview</div>
      </div>

      <label>Picture 1 URL (direct image link)</label>
      <input id="pic1" name="Picture1URL" type="url" placeholder="https://i.imgur.com/abc123.jpg" required>

      <label>Picture 2 URL (direct image link)</label>
      <input id="pic2" name="Picture2URL" type="url" placeholder="https://i.imgur.com/xyz456.png" required>

      <label>Video link (optional)</label>
      <input id="video" name="VideoURL" type="url" placeholder="https://www.youtube.com/watch?v=...">

      <p class="note">New listings are hidden until verified by the admin.</p>

      <button id="submit">Submit Hustle</button>
    </form>
  </main>
</div>

<script>
/* PASTE YOUR WEB APP URL HERE */
const WEB_APP_URL = "PASTE_YOUR_WEB_APP_URL_HERE"; // <-- set this to your deployed web app URL

const form = document.getElementById('form');
const overlay = document.getElementById('overlay');
const success = document.getElementById('success');
const pic1 = document.getElementById('pic1');
const pic2 = document.getElementById('pic2');
const thumb1 = document.getElementById('thumb1');
const thumb2 = document.getElementById('thumb2');

function showPreview(url, container){
  container.innerHTML = '';
  if (!url) { container.textContent = 'Preview unavailable'; return; }
  const img = document.createElement('img');
  img.src = url;
  img.alt = 'preview';
  img.onerror = () => { container.textContent = 'Preview unavailable — check link'; };
  container.appendChild(img);
}

pic1.addEventListener('input', () => showPreview(pic1.value.trim(), thumb1));
pic2.addEventListener('input', () => showPreview(pic2.value.trim(), thumb2));

function setLoading(flag){
  overlay.classList.toggle('show', flag);
  document.getElementById('submit').disabled = flag;
}

form.addEventListener('submit', async function(e){
  e.preventDefault();
  if (!WEB_APP_URL || WEB_APP_URL.includes('https://script.google.com/macros/s/AKfycbwYvYvaM2OtceIjmDcK4K6_OQV30uNcJV4sgiq7OdMWI-rBLP77tWSHnMFlVbetN0ey7g/exec')) {
    alert('Paste your deployed Apps Script web app URL into this file before submitting.');
    return;
  }

  const payload = {
    Name: document.getElementById('name').value.trim(),
    Email: document.getElementById('email').value.trim(),
    Skill: document.getElementById('skill').value,
    Province: document.getElementById('province').value,
    City: document.getElementById('city').value.trim(),
    Description: document.getElementById('description').value.trim(),
    Phone: document.getElementById('phone').value.trim(),
    Picture1URL: pic1.value.trim(),
    Picture2URL: pic2.value.trim(),
    VideoURL: document.getElementById('video').value.trim() || ""
  };

  if (!payload.Name || !payload.Skill || !payload.Picture1URL || !payload.Picture2URL) {
    alert('Please fill Name, Skill and both image URLs.');
    return;
  }

  setLoading(true);

  try {
    const r = await fetch(WEB_APP_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    const text = await r.text();
    let res;
    try { res = JSON.parse(text); } catch (e) { res = { status:'error', message:'Unexpected server response' }; }

    if (res.status === 'success') {
      success.classList.add('show');
      setTimeout(()=> success.classList.remove('show'), 3200);
      form.reset();
      thumb1.innerHTML = 'Picture 1 preview';
      thumb2.innerHTML = 'Picture 2 preview';
      // redirect to profile page (pending)
      if (res.id) setTimeout(()=> window.location.href = `profile.html?id=${encodeURIComponent(res.id)}`, 1200);
    } else {
      alert('Submission failed: ' + (res.message || 'Server error'));
    }

  } catch (err) {
    console.error(err);
    alert('Submission failed — check your internet and web app URL.');
  } finally {
    setLoading(false);
  }
});
</script>
</body>
  </html>
