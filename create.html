<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QuickPoster ‚Äî Create Posters & Programs</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

<!-- html2canvas & jsPDF for download (CDN) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNa5d4I6qodc0W1Gc0dw0G8Z6y8Kq5Qk+qJq5c0tq2k1u9nYrw2d0oQ2p0bX6t3h8Q6H6Z0Qe5dYfT75wQ0X0Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-O2r5cGQG1WO3mRNV7pGqhj4b2Gc6WZsN5v7fQ2qh7L0mWg0hJ+I0h7V7Bzq9T2Cjz3XKc6KqF6p7c9Xx8l0Wg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<style>
  :root{
    --bg1:#bce0fb; --bg2:#7b6cf6;
    --card-bg: rgba(255,255,255,0.95);
    --accent:#3f37c9;
    --muted:#666;
    --paper-white:#fffdfb;
  }
  html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#111}
  .wrap{max-width:1200px;margin:30px auto;padding:18px;display:grid;grid-template-columns:1fr 1fr;gap:20px}
  .panel{background:var(--card-bg);border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(17,24,39,0.12)}
  h1{margin:0 0 8px;font-weight:800;color:#fff;text-align:center; background:linear-gradient(90deg,#6dd5fa,#8e54e9); padding:12px;border-radius:10px}
  .left{min-height:520px;overflow:auto}
  label{display:block;margin-top:12px;font-weight:600;color:var(--accent)}
  input[type="text"], input[type="date"], textarea, select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e6e6;margin-top:6px;font-size:15px}
  textarea{min-height:90px;resize:vertical}
  .templates-grid{display:flex;gap:12px;margin-top:10px;flex-wrap:wrap}
  .tp{width:120px;border-radius:10px;padding:8px;background:#fafafa;border:2px solid transparent;cursor:pointer; text-align:center}
  .tp img{width:100%;height:80px;object-fit:cover;border-radius:6px}
  .tp .name{font-size:13px;margin-top:6px;color:#222}
  .tp.active{border-color:var(--accent);box-shadow:0 6px 18px rgba(63,55,201,0.12);transform:translateY(-4px)}
  .controls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .btn{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer}
  .btn.ghost{background:transparent;color:var(--accent);border:2px solid var(--accent)}
  .tip{font-size:13px;color:var(--muted);margin-top:8px}
  .right{min-height:520px;display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:flex-start}
  .preview-wrap{width:100%;max-width:520px;background:var(--paper-white);padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);position:relative}
  .poster{width:100%;height:auto;padding:18px;border-radius:8px;box-sizing:border-box;overflow:hidden}
  /* Template styles */
  .t-classic{background:#ffffff;color:#111;border:6px solid #222;font-family:'Playfair Display',serif}
  .t-modern{background:linear-gradient(180deg,#6dd5fa,#8e54e9);color:#fff;font-family:'Poppins',sans-serif}
  .t-elegant{background:#fff7f0;color:#3b2b2b;border:4px solid #d4b483;font-family:'Georgia',serif}
  .poster .title{font-size:28px;font-weight:800;margin:8px 0}
  .poster .sub{font-size:14px;color:var(--muted);margin:2px 0}
  .poster .bio{font-size:15px;margin-top:12px;line-height:1.4}
  .icons-row{display:flex;gap:12px;justify-content:center;margin-bottom:8px}
  .icons-row img{width:40px;height:40px;opacity:.95}
  .small-ctrls{display:flex;gap:8px;position:absolute;top:12px;right:12px}
  .preview-actions{display:flex;gap:8px;margin-top:8px}
  .lang-note{font-size:13px;color:var(--muted);margin-top:6px}
  /* responsive */
  @media(max-width:980px){.wrap{grid-template-columns:1fr; padding:10px} .right{align-items:center}}
</style>
</head>
<body>

  <h1>QuickPoster ‚Äî Create Posters & Programs</h1>

  <div class="wrap">
    <!-- LEFT: form & templates -->
    <div class="panel left">
      <h2 style="margin:0 0 10px;font-size:18px;color:var(--accent)">Step 1 ‚Äî Choose & Fill</h2>

      <label>Poster Type</label>
      <select id="posterType">
        <option value="obituary">üïä Obituary / Funeral</option>
        <option value="wedding">üíç Wedding Program</option>
        <option value="gathering">üë®‚Äçüë©‚Äçüëß Family Gathering</option>
        <option value="menu">üçΩ Restaurant Menu</option>
      </select>

      <label>Language</label>
      <select id="language">
        <option value="English">English</option>
        <option value="isiZulu">isiZulu</option>
        <option value="isiXhosa">isiXhosa</option>
        <option value="seSotho">Sesotho</option>
        <option value="sePedi">Sepedi</option>
        <option value="siSwati">siSwati</option>
        <option value="Xitsonga">Xitsonga</option>
        <option value="Tshivenda">Tshivenda</option>
        <option value="isiNdebele">isiNdebele</option>
        <option value="Afrikaans">Afrikaans</option>
        <option value="Setswana">Setswana</option>
      </select>

      <label id="labelMain">Main Heading / Name</label>
      <input id="fieldTitle" type="text" placeholder="e.g. In loving memory of John Doe">

      <label id="labelDates">Date(s)</label>
      <div style="display:flex;gap:8px">
        <input id="fieldDate1" type="date">
        <input id="fieldDate2" type="date">
      </div>

      <label id="labelDetails">Details / Message</label>
      <textarea id="fieldDetails" placeholder="e.g. Leaves behind 2 children. Service at the community hall..."></textarea>

      <!-- conditional fields -->
      <div id="extraFields"></div>

      <label>Choose Template</label>
      <div class="templates-grid" id="templateGrid">
        <div class="tp" data-template="Classic" title="Classic ‚Äî formal black & white">
          <img src="https://images.unsplash.com/photo-1503264116251-35a269479413?q=80&w=600&auto=format&fit=crop&ixlib=rb-4.0.3&s=ad8aa7e8c7aed69c0544ac3b7b0c2d90" alt="">
          <div class="name">Classic</div>
        </div>
        <div class="tp" data-template="Modern" title="Modern ‚Äî colored gradient">
          <img src="https://images.unsplash.com/photo-1517511620798-cec17d428bc0?q=80&w=600&auto=format&fit=crop&ixlib=rb-4.0.3&s=1d8fcc60cec4b33e6b6c6e5fd8f6d8ff" alt="">
          <div class="name">Modern</div>
        </div>
        <div class="tp" data-template="Elegant" title="Elegant ‚Äî soft & gold">
          <img src="https://images.unsplash.com/photo-1487412947147-5cebf100ffc2?q=80&w=600&auto=format&fit=crop&ixlib=rb-4.0.3&s=9c7b9f4d3b3d5984f6b0c3a3d2f17f6e" alt="">
          <div class="name">Elegant</div>
        </div>
      </div>

      <div class="controls">
        <button class="btn" id="btnPreview">Live Preview</button>
        <button class="btn ghost" id="btnReset">Reset</button>
      </div>

      <p class="tip">Tip: Choose a template that fits the mood. For obituaries, Classic or Elegant often looks best. For menus, Modern works well.</p>
      <p class="lang-note">Language labels change. You can still type any text in the message box ‚Äî enter local words/phrases freely.</p>
    </div>

    <!-- RIGHT: live preview -->
    <div class="panel right">
      <h2 style="margin:0 0 10px;font-size:18px;color:var(--accent)">Step 2 ‚Äî Edit & Download</h2>

      <div class="preview-wrap">
        <div class="small-ctrls">
          <button class="btn ghost" id="btnToggleIcons" title="Toggle decorative icons">Icons</button>
          <button class="btn ghost" id="btnFontSmall" title="Smaller title">A-</button>
          <button class="btn ghost" id="btnFontBig" title="Bigger title">A+</button>
        </div>

        <div id="previewPoster" class="poster t-classic">
          <div class="icons-row" id="topIcons"></div>
          <div style="text-align:center">
            <div class="title" id="pvTitle">[Title]</div>
            <div class="sub" id="pvDates">Date(s)</div>
            <div class="sub" id="pvExtra"></div>
            <div class="bio" id="pvDetails">Details / message</div>
          </div>
          <div class="icons-row" id="bottomIcons"></div>
        </div>

        <div class="preview-actions" style="margin-top:10px">
          <button class="btn" id="downloadPNG">Download PNG</button>
          <button class="btn" id="downloadPDF">Download PDF</button>
          <button class="btn ghost" id="shareLink">Copy Share Link</button>
        </div>

        <p class="tip" style="font-size:13px;margin-top:10px">After downloading, you can print at any shop. For higher print quality choose PDF and set paper size to A4 when printing.</p>
      </div>

    </div>
  </div>

<script>
/* ---------- language templates for static headings (examples) ---------- */
const LANG_HDR = {
  "English": {
    "inMemory": "In Loving Memory",
    "survivedBy": "Survived by",
    "serviceAt": "Service at",
    "program": "Order of Service"
  },
  "isiZulu": {
    "inMemory": "Ngokuthandekayo Sikhumbula",
    "survivedBy": "Ashiywe ngu",
    "serviceAt": "Inkonzo izoba ku",
    "program": "Uhlelo Lwenkonzo"
  },
  "isiXhosa": {
    "inMemory":"Sikhumbula Ngenkathalo",
    "survivedBy":"Usishiyile",
    "serviceAt":"Inkqubo iya kuba",
    "program":"Uhlelo Lwenkonzo"
  },
  "Setswana": {
    "inMemory":"Ka Lorato Re Gopola",
    "survivedBy":"O siile morago",
    "serviceAt":"Lenaneo la Temo≈°o",
    "program":"Moralo wa Tshepo"
  },
  "Sesotho": {
    "inMemory":"Re Mo Hopolang ka Lerato",
    "survivedBy":"O sietse morao",
    "serviceAt":"Puo ya Kereke",
    "program":"Lenane la Temo"
  },
  "Afrikaans": {
    "inMemory":"Ter Aandenking",
    "survivedBy":"Agtergelaat deur",
    "serviceAt":"Diens by",
    "program":"Program"
  },
  // fallback same as English for other SA languages
  "Sepedi": {"inMemory":"In Loving Memory","survivedBy":"Survived by","serviceAt":"Service at","program":"Program"},
  "siSwati": {"inMemory":"In Loving Memory","survivedBy":"Survived by","serviceAt":"Service at","program":"Program"},
  "Xitsonga": {"inMemory":"In Loving Memory","survivedBy":"Survived by","serviceAt":"Service at","program":"Program"},
  "Tshivenda": {"inMemory":"In Loving Memory","survivedBy":"Survived by","serviceAt":"Service at","program":"Program"},
  "isiNdebele": {"inMemory":"In Loving Memory","survivedBy":"Survived by","serviceAt":"Service at","program":"Program"}
};

/* ---------- DOM refs ---------- */
const posterType = document.getElementById('posterType');
const language = document.getElementById('language');
const fieldTitle = document.getElementById('fieldTitle');
const fieldDate1 = document.getElementById('fieldDate1');
const fieldDate2 = document.getElementById('fieldDate2');
const fieldDetails = document.getElementById('fieldDetails');
const extraFields = document.getElementById('extraFields');

const templateGrid = document.getElementById('templateGrid');
const pv = document.getElementById('previewPoster');
const pvTitle = document.getElementById('pvTitle');
const pvDates = document.getElementById('pvDates');
const pvDetails = document.getElementById('pvDetails');
const pvExtra = document.getElementById('pvExtra');
const topIcons = document.getElementById('topIcons');
const bottomIcons = document.getElementById('bottomIcons');

let selectedTemplate = 'Classic';
let showIcons = true;
let titleSize = 28;

/* ---------- template selection ---------- */
templateGrid.querySelectorAll('.tp').forEach(tp=>{
  tp.addEventListener('click',()=>{
    templateGrid.querySelectorAll('.tp').forEach(x=>x.classList.remove('active'));
    tp.classList.add('active');
    selectedTemplate = tp.dataset.template;
    refreshPreview();
  });
});
// default select first
templateGrid.querySelector('.tp').classList.add('active');

/* ---------- update preview from fields ---------- */
function refreshPreview(){
  // template classes
  pv.className = 'poster';
  const tcls = (selectedTemplate==='Classic')? 't-classic' : (selectedTemplate==='Modern')? 't-modern' : 't-elegant';
  pv.classList.add(tcls);

  // title and dates
  let titleText = fieldTitle.value.trim() || (LANG_HDR[language.value] ? LANG_HDR[language.value].inMemory : 'In Loving Memory');
  pvTitle.textContent = titleText;
  // dates
  const d1 = fieldDate1.value ? (new Date(fieldDate1.value)).toLocaleDateString() : '';
  const d2 = fieldDate2.value ? (new Date(fieldDate2.value)).toLocaleDateString() : '';
  pvDates.textContent = (d1 && d2) ? `${d1} ‚Äî ${d2}` : (d1 || d2 || '');

  // details / message
  pvDetails.textContent = fieldDetails.value.trim() || (posterType.value === 'menu' ? '‚Äî Menu items here ‚Äî' : 'Details / message');

  // conditional extra fields text
  if(posterType.value === 'obituary'){
    pvExtra.textContent = LANG_HDR[language.value] ? LANG_HDR[language.value].survivedBy + ': (e.g. wife, 2 children)' : 'Survived by:';
  } else if (posterType.value === 'wedding'){
    pvExtra.textContent = 'Venue & Time';
  } else if (posterType.value === 'gathering'){
    pvExtra.textContent = 'Venue / Contact';
  } else if (posterType.value === 'menu'){
    pvExtra.textContent = 'Menu ‚Äî add items in details box (each line is an item)';
  } else pvExtra.textContent = '';

  // icons insertion
  topIcons.innerHTML = '';
  bottomIcons.innerHTML = '';
  if(showIcons){
    if(selectedTemplate === 'Classic'){
      topIcons.innerHTML = `<img src="https://img.icons8.com/ios-filled/100/000000/dove.png" alt="dove">
                            <img src="https://img.icons8.com/ios-filled/100/000000/candle.png" alt="candle">`;
      bottomIcons.innerHTML = `<img src="https://img.icons8.com/ios-filled/100/000000/flower.png" alt="flower">`;
    }
    if(selectedTemplate === 'Modern'){
      topIcons.innerHTML = `<img src="https://img.icons8.com/ios-filled/100/ffffff/angel.png" alt="angel">
                            <img src="https://img.icons8.com/ios-filled/100/ffffff/dove.png" alt="dove">`;
      bottomIcons.innerHTML = `<img src="https://img.icons8.com/ios-filled/100/ffffff/praying-hands.png" alt="pray">`;
    }
    if(selectedTemplate === 'Elegant'){
      topIcons.innerHTML = `<img src="https://img.icons8.com/ios-filled/96/d4b483/lotus.png" alt="lotus">`;
      bottomIcons.innerHTML = `<img src="https://img.icons8.com/ios-filled/96/d4b483/heart-with-ribbon.png" alt="heart">`;
    }
  }

  pvTitle.style.fontSize = (titleSize) + 'px';
}

/* ---------- dynamic extra fields for type ---------- */
function renderExtra(){
  extraFields.innerHTML = '';
  if(posterType.value === 'obituary'){
    extraFields.innerHTML = `<label>Survived By (e.g. wife, 2 children)</label>
      <input id="survivedBy" type="text" placeholder="e.g. Wife: Maria; Children: Lerato (10), Kgotso (7)">
      <label>Service Venue</label><input id="serviceVenue" type="text" placeholder="e.g. Community Hall, Mahikeng">`;
  } else if(posterType.value === 'wedding'){
    extraFields.innerHTML = `<label>Bride & Groom</label><input id="bgNames" type="text" placeholder="e.g. Thabo & Naledi">
      <label>Venue & Time</label><input id="venueTime" type="text" placeholder="e.g. Gardens, 10:00 AM">`;
  } else if(posterType.value === 'gathering'){
    extraFields.innerHTML = `<label>Host Name</label><input id="hostName" type="text" placeholder="e.g. The Molamu Family">
      <label>Venue</label><input id="gVenue" type="text" placeholder="e.g. Uncle Joe's place">`;
  } else if(posterType.value === 'menu'){
    extraFields.innerHTML = `<label>Restaurant Name</label><input id="restName" type="text" placeholder="e.g. Sello's Kitchen">
      <label>Menu Note (e.g. drinks, sides)</label><input id="menuNote" type="text" placeholder="e.g. Available 8am - 9pm">`;
  }
}

/* ---------- event listeners ---------- */
posterType.addEventListener('change', ()=>{
  // adjust some labels to match type
  const type = posterType.value;
  if(type === 'obituary'){ document.getElementById('labelMain').textContent = 'Full Name (of deceased)'; document.getElementById('labelDates').textContent = 'Date of Birth ‚Äî Date of Passing'; }
  else if(type === 'wedding'){ document.getElementById('labelMain').textContent = 'Event Title (e.g. Wedding of X & Y)'; document.getElementById('labelDates').textContent = 'Wedding Date'; }
  else if(type === 'gathering'){ document.getElementById('labelMain').textContent = 'Event Title / Host'; document.getElementById('labelDates').textContent = 'Event Date'; }
  else { document.getElementById('labelMain').textContent = 'Title / Restaurant Name'; document.getElementById('labelDates').textContent = 'Available From / Date'; }
  renderExtra(); refreshPreview();
});

language.addEventListener('change', ()=>refreshPreview());
fieldTitle.addEventListener('input', ()=>refreshPreview());
fieldDate1.addEventListener('change', ()=>refreshPreview());
fieldDate2.addEventListener('change', ()=>refreshPreview());
fieldDetails.addEventListener('input', ()=>refreshPreview());

document.getElementById('btnPreview').addEventListener('click', (e)=>{ e.preventDefault(); refreshPreview(); window.scrollTo({top:0,behavior:'smooth'}); });
document.getElementById('btnReset').addEventListener('click', ()=>{
  fieldTitle.value=''; fieldDate1.value=''; fieldDate2.value=''; fieldDetails.value=''; selectedTemplate='Classic';
  templateGrid.querySelectorAll('.tp').forEach(x=>x.classList.remove('active')); templateGrid.querySelector('.tp').classList.add('active');
  renderExtra(); refreshPreview();
});

/* small preview controls */
document.getElementById('btnToggleIcons').addEventListener('click', ()=>{ showIcons = !showIcons; refreshPreview();});
document.getElementById('btnFontSmall').addEventListener('click', ()=>{ titleSize = Math.max(16, titleSize - 2); refreshPreview();});
document.getElementById('btnFontBig').addEventListener('click', ()=>{ titleSize = Math.min(48, titleSize + 2); refreshPreview();});

/* update extra inputs to update preview */
extraFields.addEventListener('input', (e)=> {
  // map values into pvExtra or pvDetails where suitable
  if(posterType.value==='obituary'){
    const survived = document.getElementById('survivedBy') ? document.getElementById('survivedBy').value : '';
    const venue = document.getElementById('serviceVenue') ? document.getElementById('serviceVenue').value : '';
    pvExtra.textContent = (LANG_HDR[language.value] ? LANG_HDR[language.value].survivedBy + ': ' : 'Survived by:') + (survived || '');
    if(venue) pvDetails.textContent = (fieldDetails.value || '') + '\n' + (LANG_HDR[language.value] ? LANG_HDR[language.value].serviceAt + ': ' : 'Service at: ') + venue;
  } else if(posterType.value==='wedding'){
    const bg = document.getElementById('bgNames') ? document.getElementById('bgNames').value : '';
    const v = document.getElementById('venueTime') ? document.getElementById('venueTime').value : '';
    pvExtra.textContent = (bg || '');
    pvDetails.textContent = (fieldDetails.value || '') + (v ? '\nVenue: ' + v : '');
  } else if(posterType.value==='gathering'){
    const host = document.getElementById('hostName') ? document.getElementById('hostName').value : '';
    const gV = document.getElementById('gVenue') ? document.getElementById('gVenue').value : '';
    pvExtra.textContent = host;
    pvDetails.textContent = (fieldDetails.value || '') + (gV ? '\nVenue: ' + gV : '');
  } else if(posterType.value==='menu'){
    const r = document.getElementById('restName') ? document.getElementById('restName').value : '';
    const mn = document.getElementById('menuNote') ? document.getElementById('menuNote').value : '';
    pvTitle.textContent = r || (fieldTitle.value || 'Menu');
    pvDetails.textContent = fieldDetails.value || 'Add items each line: Dish - Rprice';
    pvExtra.textContent = mn;
  }
});

/* ---------- download functions ---------- */
async function downloadPNG(){
  refreshPreview(); // ensure updated
  // temporarily scale to higher resolution for clarity
  const node = document.getElementById('previewPoster');
  const originalWidth = node.offsetWidth;
  const scale = 2; // increase to improve quality
  const canvas = await html2canvas(node, {scale: scale, backgroundColor: null});
  const dataUrl = canvas.toDataURL('image/png');
  // trigger download
  const a = document.createElement('a');
  a.href = dataUrl;
  a.download = `${(fieldTitle.value||'poster').replace(/\s+/g,'_')}.png`;
  document.body.appendChild(a);
  a.click();
  a.remove();
}

async function downloadPDF(){
  refreshPreview();
  const node = document.getElementById('previewPoster');
  // render at good resolution
  const canvas = await html2canvas(node, {scale:2, backgroundColor: null});
  const imgData = canvas.toDataURL('image/png');
  const { jsPDF } = window.jspdf;
  // create PDF with A4 aspect ratio
  const pdf = new jsPDF({
    orientation: 'portrait',
    unit: 'pt',
    format: 'a4'
  });
  // calculate image size to fit width with margins
  const pageWidth = pdf.internal.pageSize.getWidth();
  const pageHeight = pdf.internal.pageSize.getHeight();
  const margin = 40;
  const imgWidth = pageWidth - margin*2;
  const imgHeight = (canvas.height * imgWidth) / canvas.width;
  pdf.addImage(imgData, 'PNG', margin, margin, imgWidth, imgHeight);
  const fname = `${(fieldTitle.value||'poster').replace(/\s+/g,'_')}.pdf`;
  pdf.save(fname);
}

/* share link ‚Äî encodes form values into URL for later */
function copyShareLink(){
  const obj = {
    t: selectedTemplate,
    type: posterType.value,
    lang: language.value,
    title: fieldTitle.value,
    d1: fieldDate1.value,
    d2: fieldDate2.value,
    details: fieldDetails.value
  };
  // include extras
  if(document.getElementById('survivedBy')) obj.survived = document.getElementById('survivedBy').value;
  if(document.getElementById('serviceVenue')) obj.venue = document.getElementById('serviceVenue').value;
  if(document.getElementById('bgNames')) obj.bg = document.getElementById('bgNames').value;
  if(document.getElementById('venueTime')) obj.vtime = document.getElementById('venueTime').value;
  if(document.getElementById('hostName')) obj.host = document.getElementById('hostName').value;
  if(document.getElementById('gVenue')) obj.gvenue = document.getElementById('gVenue').value;
  if(document.getElementById('restName')) obj.rest = document.getElementById('restName').value;
  if(document.getElementById('menuNote')) obj.mnote = document.getElementById('menuNote').value;

  const base = location.protocol + '//' + location.host + location.pathname;
  const params = new URLSearchParams(obj).toString();
  const link = base + '?' + params;
  navigator.clipboard.writeText(link).then(()=> alert('Share link copied to clipboard!'));
}

/* on load: render extras & preview */
renderExtra(); refreshPreview();

document.getElementById('downloadPNG').addEventListener('click', downloadPNG);
document.getElementById('downloadPDF').addEventListener('click', downloadPDF);
document.getElementById('shareLink').addEventListener('click', copyShareLink);

/* If page opened with query string, populate fields (share link) */
(function loadFromURL(){
  const qs = new URLSearchParams(location.search);
  if([...qs].length === 0) return;
  if(qs.get('type')) posterType.value = qs.get('type');
  if(qs.get('lang')) language.value = qs.get('lang');
  if(qs.get('title')) fieldTitle.value = qs.get('title');
  if(qs.get('d1')) fieldDate1.value = qs.get('d1');
  if(qs.get('d2')) fieldDate2.value = qs.get('d2');
  if(qs.get('details')) fieldDetails.value = qs.get('details');
  if(qs.get('t')) {
    selectedTemplate = qs.get('t');
    templateGrid.querySelectorAll('.tp').forEach(x=>{ x.classList.toggle('active', x.dataset.template===selectedTemplate) });
  }
  renderExtra();
  // populate extras if any
  setTimeout(()=> {
    if(qs.get('survived') && document.getElementById('survivedBy')) document.getElementById('survivedBy').value = qs.get('survived');
    if(qs.get('venue') && document.getElementById('serviceVenue')) document.getElementById('serviceVenue').value = qs.get('venue');
    if(qs.get('bg') && document.getElementById('bgNames')) document.getElementById('bgNames').value = qs.get('bg');
    if(qs.get('vtime') && document.getElementById('venueTime')) document.getElementById('venueTime').value = qs.get('vtime');
    if(qs.get('host') && document.getElementById('hostName')) document.getElementById('hostName').value = qs.get('host');
    if(qs.get('gvenue') && document.getElementById('gVenue')) document.getElementById('gVenue').value = qs.get('gvenue');
    if(qs.get('rest') && document.getElementById('restName')) document.getElementById('restName').value = qs.get('rest');
    if(qs.get('mnote') && document.getElementById('menuNote')) document.getElementById('menuNote').value = qs.get('mnote');
    refreshPreview();
  }, 300);
})();
</script>

</body>
                                                                                               </html>
