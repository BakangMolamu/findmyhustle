<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>QuickPoster ‚Äî Create Posters & Programs</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --bg1:#bce0fb; --bg2:#7b6cf6;
  --card-bg: rgba(255,255,255,0.95);
  --accent:#3f37c9;
  --muted:#666;
  --paper-white:#fffdfb;
}
body{margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#111}
h1{margin:0;padding:12px;text-align:center;color:#fff;background:linear-gradient(90deg,#6dd5fa,#8e54e9);border-radius:10px;font-weight:800}
.wrap{max-width:1200px;margin:20px auto;display:grid;grid-template-columns:1fr 1fr;gap:20px;padding:10px}
.panel{background:var(--card-bg);border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(17,24,39,0.12)}
.left label{display:block;margin-top:12px;font-weight:600;color:var(--accent)}
.left input, .left textarea, .left select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e6e6;margin-top:6px;font-size:15px}
textarea{min-height:80px;resize:vertical}
.templates-grid{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
.tp{width:120px;border-radius:10px;padding:8px;background:#fafafa;border:2px solid transparent;cursor:pointer;text-align:center}
.tp img{width:100%;height:80px;object-fit:cover;border-radius:6px}
.tp.active{border-color:var(--accent);box-shadow:0 6px 18px rgba(63,55,201,0.12);transform:translateY(-4px)}
.right{display:flex;flex-direction:column;gap:12px;align-items:center}
.preview-wrap{width:100%;max-width:520px;background:var(--paper-white);padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08)}
.poster{width:100%;margin-bottom:20px;padding:18px;border-radius:8px;background:#fff;box-sizing:border-box}
.poster .title{font-size:28px;font-weight:800;margin:8px 0;text-align:center}
.poster .sub{font-size:14px;color:var(--muted);margin:2px 0;text-align:center}
.poster .bio{font-size:15px;margin-top:12px;line-height:1.4;text-align:center}
.btn{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer}
.btn.ghost{background:transparent;color:var(--accent);border:2px solid var(--accent)}
.controls, .preview-actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
@media(max-width:980px){.wrap{grid-template-columns:1fr}}
</style>
</head>
<body>

<h1>QuickPoster ‚Äî Create Posters & Programs</h1>

<div class="wrap">
  <!-- LEFT: form & templates -->
  <div class="panel left">
    <h2 style="margin:0 0 10px;font-size:18px;color:var(--accent)">Step 1 ‚Äî Pick Type & Template</h2>

    <label>Poster Type</label>
    <select id="posterType">
      <option value="">-- Select Poster Type --</option>
      <option value="obituary">üïä Obituary / Funeral</option>
      <option value="wedding">üíç Wedding Program</option>
      <option value="gathering">üë®‚Äçüë©‚Äçüëß Family Gathering</option>
      <option value="menu">üçΩ Restaurant Menu</option>
    </select>

    <label>Choose Template</label>
    <div class="templates-grid" id="templateGrid"></div>

    <div id="extraFields"></div>

    <div class="controls">
      <button class="btn" id="btnPreview">Live Preview</button>
      <button class="btn ghost" id="btnReset">Reset</button>
    </div>
  </div>

  <!-- RIGHT: live preview -->
  <div class="panel right">
    <h2 style="margin:0 0 10px;font-size:18px;color:var(--accent)">Step 2 ‚Äî Preview & Download</h2>
    <div class="preview-wrap" id="previewWrap"></div>
    <div class="preview-actions">
      <button class="btn" id="downloadPNG">Download PNG</button>
      <button class="btn" id="downloadPDF">Download PDF</button>
    </div>
  </div>
</div>

<script>
// --- Poster templates per type ---
const TEMPLATES = {
  obituary:[
    {name:'Classic', pages:['https://i.imgur.com/Lt2d8KX.png','https://i.imgur.com/YuO7Svn.png']},
    {name:'Elegant', pages:['https://i.imgur.com/uQfZ2Tq.png','https://i.imgur.com/F0Xx3l7.png']}
  ],
  wedding:[
    {name:'Modern', pages:['https://i.imgur.com/kH5ZbO5.png','https://i.imgur.com/If9FhRw.png']},
    {name:'Elegant', pages:['https://i.imgur.com/0nH5aD6.png','https://i.imgur.com/Hvdp0Fg.png']}
  ],
  gathering:[
    {name:'Classic', pages:['https://i.imgur.com/fXkZr0M.png']},
    {name:'Modern', pages:['https://i.imgur.com/3qwlZ6b.png']}
  ],
  menu:[
    {name:'Modern', pages:['https://i.imgur.com/0eWnH3l.png']},
    {name:'Classic', pages:['https://i.imgur.com/4l7QgRt.png']}
  ]
};

const posterType = document.getElementById('posterType');
const templateGrid = document.getElementById('templateGrid');
const extraFields = document.getElementById('extraFields');
const previewWrap = document.getElementById('previewWrap');
let selectedTemplate = null;

// --- Render templates grid ---
posterType.addEventListener('change', ()=>{
  selectedTemplate=null;
  renderTemplates();
  renderExtraFields();
  previewWrap.innerHTML='';
});

function renderTemplates(){
  templateGrid.innerHTML='';
  const type = posterType.value;
  if(!type) return;
  TEMPLATES[type].forEach((t,idx)=>{
    const div=document.createElement('div');
    div.className='tp';
    div.dataset.idx=idx;
    div.innerHTML=`<img src="${t.pages[0]}" alt="${t.name}"><div>${t.name}</div>`;
    div.addEventListener('click',()=>{
      templateGrid.querySelectorAll('.tp').forEach(x=>x.classList.remove('active'));
      div.classList.add('active');
      selectedTemplate=t;
      renderPreview();
    });
    templateGrid.appendChild(div);
  });
}

// --- Render type-specific fields ---
function renderExtraFields(){
  extraFields.innerHTML='';
  const type = posterType.value;
  if(type==='obituary'){
    extraFields.innerHTML=`
      <label>Full Name</label><input id="nameField" type="text">
      <label>Date of Birth</label><input id="dobField" type="date">
      <label>Date of Passing</label><input id="dodField" type="date">
      <label>Survived By</label><input id="survivedField" type="text">
      <label>Service Venue</label><input id="venueField" type="text">
      <label>Message / Details</label><textarea id="detailsField"></textarea>
    `;
  } else if(type==='wedding'){
    extraFields.innerHTML=`
      <label>Bride & Groom</label><input id="bgField" type="text">
      <label>Date</label><input id="dateField" type="date">
      <label>Venue & Time</label><input id="venueField" type="text">
      <label>Notes / Order of Service</label><textarea id="detailsField"></textarea>
    `;
  } else if(type==='gathering'){
    extraFields.innerHTML=`
      <label>Host Name</label><input id="hostField" type="text">
      <label>Date</label><input id="dateField" type="date">
      <label>Venue</label><input id="venueField" type="text">
      <label>Notes</label><textarea id="detailsField"></textarea>
    `;
  } else if(type==='menu'){
    extraFields.innerHTML=`
      <label>Restaurant Name</label><input id="restField" type="text">
      <label>Menu Items (one per line)</label><textarea id="itemsField"></textarea>
    `;
  }
}

// --- Render live preview ---
function renderPreview(){
  if(!selectedTemplate) return;
  const type=posterType.value;
  previewWrap.innerHTML='';
  selectedTemplate.pages.forEach((page,idx)=>{
    const div=document.createElement('div');
    div.className='poster';
    div.innerHTML=`<img src="${page}" style="width:100%;border-radius:8px;margin-bottom:12px">`;
    // inject text
    if(type==='obituary'){
      const name=document.getElementById('nameField')?.value||'Full Name';
      const dob=document.getElementById('dobField')?.value||'Date of Birth';
      const dod=document.getElementById('dodField')?.value||'Date of Passing';
      const survived=document.getElementById('survivedField')?.value||'Survived By';
      const venue=document.getElementById('venueField')?.value||'Venue';
      const details=document.getElementById('detailsField')?.value||'Message';
      div.innerHTML+=`
        <div class="title">${name}</div>
        <div class="sub">${dob} - ${dod}</div>
        <div class="sub">Survived By: ${survived}</div>
        <div class="sub">Service: ${venue}</div>
        <div class="bio">${details}</div>
      `;
    } else if(type==='wedding'){
      const bg=document.getElementById('bgField')?.value||'Bride & Groom';
      const date=document.getElementById('dateField')?.value||'Date';
      const venue=document.getElementById('venueField')?.value||'Venue';
      const details=document.getElementById('detailsField')?.value||'Notes';
      div.innerHTML+=`
        <div class="title">${bg}</div>
        <div class="sub">${date}</div>
        <div class="sub">${venue}</div>
        <div class="bio">${details}</div>
      `;
    } else if(type==='gathering'){
      const host=document.getElementById('hostField')?.value||'Host';
      const date=document.getElementById('dateField')?.value||'Date';
      const venue=document.getElementById('venueField')?.value||'Venue';
      const details=document.getElementById('detailsField')?.value||'Notes';
      div.innerHTML+=`
        <div class="title">${host}</div>
        <div class="sub">${date}</div>
        <div class="sub">${venue}</div>
        <div class="bio">${details}</div>
      `;
    } else if(type==='menu'){
      const rest=document.getElementById('restField')?.value||'Restaurant';
      const items=document.getElementById('itemsField')?.value.split('\n').map(i=>`<div>${i}</div>`).join('');
      div.innerHTML+=`
        <div class="title">${rest}</div>
        <div class="bio">${items}</div>
      `;
    }
    previewWrap.appendChild(div);
  });
}

// --- Button events ---
document.getElementById('btnPreview').addEventListener('click',renderPreview);
document.getElementById('btnReset').addEventListener('click',()=>{
  posterType.value='';
  templateGrid.innerHTML='';
  extraFields.innerHTML='';
  previewWrap.innerHTML='';
  selectedTemplate=null;
});

// --- Download PNG ---
document.getElementById('downloadPNG').addEventListener('click',()=>{
  const posters = previewWrap.querySelectorAll('.poster');
  posters.forEach((p,idx)=>{
    html2canvas(p).then(canvas=>{
      const link=document.createElement('a');
      link.download=`poster_page${idx+1}.png`;
      link.href=canvas.toDataURL();
      link.click();
    });
  });
});

// --- Download PDF ---
document.getElementById('downloadPDF').addEventListener('click',()=>{
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const posters = previewWrap.querySelectorAll('.poster');
  let promises = [];
  posters.forEach((p,idx)=>{
    promises.push(html2canvas(p).then(canvas=>{
      const imgData = canvas.toDataURL('image/png');
      if(idx>0) doc.addPage();
      doc.addImage(imgData,'PNG',10,10,190,0);
    }));
  });
  Promise.all(promises).then(()=>doc.save('poster.pdf'));
});
</script>

</body>
</html>
